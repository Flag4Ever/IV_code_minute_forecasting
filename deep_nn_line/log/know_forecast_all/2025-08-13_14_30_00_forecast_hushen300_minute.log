==========================================
训练开始时间: 2025-10-19 01:51:19
分钟: 2025-08-13 14:30:00 | 划分: forecast | 设备: cuda
标记列: train_flag_inter
==========================================
加载数据: ../data/hushen300_minute/hushen300_minute.csv
筛选分钟: 2025-08-13 14:30:00
筛选后数据行数: 120
按照 train_flag_inter=1 筛选后数据行数: 120
加载初始化模型: ./checkpoint/know_forecast_all/hushen300_minute_forecast_clear/init_model/seed_1234_0.1_lr_0.001_gen_lr_0.001_w_d_0.0_best_model.pth
使用 torch.compile 优化模型 (设备: cuda)
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Glow模型使用 CUDA
加载Glow模型: ../glow_nn_line/glow_nn_svi_2/model_500000.pt
使用 torch.compile 优化 Glow 模型
开始训练，总轮数: 20000, 第一阶段: 0
Save!Epoch 1 Loss: -0.00495;Gen: -3.47204;fit arb:  0.34225;lr: 0.00100; no_improve: 0
Save!Epoch 2 Loss: -0.02113;Gen: -3.56890;fit arb:  0.33576;lr: 0.00100; no_improve: 0
Save!Epoch 3 Loss: -0.02307;Gen: -3.55341;fit arb:  0.33227;lr: 0.00100; no_improve: 0
Save!Epoch 4 Loss: -0.02427;Gen: -3.48062;fit arb:  0.32379;lr: 0.00100; no_improve: 0
Save!Epoch 19 Loss: -0.04942;Gen: -3.68233;fit arb:  0.31882;lr: 0.00100; no_improve: 14
Save!Epoch 20 Loss: -0.05124;Gen: -3.66503;fit arb:  0.31526;lr: 0.00100; no_improve: 0
Save!Epoch 31 Loss: -0.07382;Gen: -3.77755;fit arb:  0.30394;lr: 0.00100; no_improve: 10
Save!Epoch 32 Loss: -0.06825;Gen: -3.67691;fit arb:  0.29944;lr: 0.00100; no_improve: 0
Save!Epoch 42 Loss: -0.09118;Gen: -3.72424;fit arb:  0.28125;lr: 0.00100; no_improve: 9
Save!Epoch 43 Loss: -0.10073;Gen: -3.66761;fit arb:  0.26603;lr: 0.00100; no_improve: 0
Save!Epoch 52 Loss: -0.10550;Gen: -3.64700;fit arb:  0.25920;lr: 0.00100; no_improve: 8
Save!Epoch 53 Loss: -0.11390;Gen: -3.62939;fit arb:  0.24904;lr: 0.00100; no_improve: 0
Save!Epoch 54 Loss: -0.11867;Gen: -3.59231;fit arb:  0.24056;lr: 0.00100; no_improve: 0
Save!Epoch 55 Loss: -0.13032;Gen: -3.66329;fit arb:  0.23601;lr: 0.00100; no_improve: 0
Save!Epoch 64 Loss: -0.13423;Gen: -3.64389;fit arb:  0.23015;lr: 0.00100; no_improve: 8
Save!Epoch 65 Loss: -0.14663;Gen: -3.68625;fit arb:  0.22200;lr: 0.00100; no_improve: 0
Save!Epoch 74 Loss: -0.15908;Gen: -3.64015;fit arb:  0.20494;lr: 0.00100; no_improve: 8
Save!Epoch 75 Loss: -0.17292;Gen: -3.65273;fit arb:  0.19236;lr: 0.00100; no_improve: 0
Save!Epoch 84 Loss: -0.16946;Gen: -3.53240;fit arb:  0.18378;lr: 0.00100; no_improve: 8
Save!Epoch 85 Loss: -0.18675;Gen: -3.60282;fit arb:  0.17354;lr: 0.00100; no_improve: 0
Save!Epoch 94 Loss: -0.18135;Gen: -3.48590;fit arb:  0.16724;lr: 0.00100; no_improve: 8
Save!Epoch 102 Loss: -0.18717;Gen: -3.45699;fit arb:  0.15853;lr: 0.00100; no_improve: 7
Save!Epoch 103 Loss: -0.18306;Gen: -3.35717;fit arb:  0.15266;lr: 0.00100; no_improve: 0
Save!Epoch 112 Loss: -0.20893;Gen: -3.52811;fit arb:  0.14389;lr: 0.00100; no_improve: 8
Save!Epoch 129 Loss: -0.19245;Gen: -3.33480;fit arb:  0.14103;lr: 0.00100; no_improve: 16
Save!Epoch 130 Loss: -0.19913;Gen: -3.36158;fit arb:  0.13703;lr: 0.00100; no_improve: 0
Save!Epoch 145 Loss: -0.20195;Gen: -3.27827;fit arb:  0.12588;lr: 0.00100; no_improve: 14
Save!Epoch 146 Loss: -0.20880;Gen: -3.29958;fit arb:  0.12115;lr: 0.00100; no_improve: 0
Save!Epoch 202 Loss: -0.22589;Gen: -3.34285;fit arb:  0.10839;lr: 0.00100; no_improve: 55
Save!Epoch 203 Loss: -0.23106;Gen: -3.36081;fit arb:  0.10502;lr: 0.00100; no_improve: 0
Save!Epoch 321 Loss: -0.23151;Gen: -3.35302;fit arb:  0.10379;lr: 0.00100; no_improve: 117
Save!Epoch 322 Loss: -0.23531;Gen: -3.34079;fit arb:  0.09877;lr: 0.00100; no_improve: 0
Save!Epoch 366 Loss: -0.23619;Gen: -3.32233;fit arb:  0.09605;lr: 0.00100; no_improve: 43
Save!Epoch 382 Loss: -0.24239;Gen: -3.36359;fit arb:  0.09396;lr: 0.00100; no_improve: 15
Save!Epoch 435 Loss: -0.23663;Gen: -3.29248;fit arb:  0.09262;lr: 0.00100; no_improve: 52
Save!Epoch 496 Loss: -0.24507;Gen: -3.36740;fit arb:  0.09167;lr: 0.00100; no_improve: 60
Save!Epoch 526 Loss: -0.23877;Gen: -3.28447;fit arb:  0.08968;lr: 0.00100; no_improve: 29
Save!Epoch 588 Loss: -0.23512;Gen: -3.21850;fit arb:  0.08673;lr: 0.00100; no_improve: 61
Save!Epoch 647 Loss: -0.25033;Gen: -3.36116;fit arb:  0.08579;lr: 0.00100; no_improve: 58
Save!Epoch 685 Loss: -0.25572;Gen: -3.38487;fit arb:  0.08276;lr: 0.00100; no_improve: 37
Save!Epoch 767 Loss: -0.24617;Gen: -3.26633;fit arb:  0.08046;lr: 0.00100; no_improve: 81
Save!Epoch 857 Loss: -0.25465;Gen: -3.33412;fit arb:  0.07876;lr: 0.00100; no_improve: 89
Save!Epoch 950 Loss: -0.24932;Gen: -3.27282;fit arb:  0.07796;lr: 0.00100; no_improve: 92
Epoch 1000 Loss: -0.21709;Gen: -3.32692;fit arb:  0.11561;lr: 0.00100;no_improve: 50
Save!Epoch 1003 Loss: -0.26263;Gen: -3.35281;fit arb:  0.07265;lr: 0.00100; no_improve: 52
Save!Epoch 1239 Loss: -0.26278;Gen: -3.32460;fit arb:  0.06968;lr: 0.00100; no_improve: 235
Save!Epoch 1330 Loss: -0.26397;Gen: -3.31513;fit arb:  0.06754;lr: 0.00100; no_improve: 90
Save!Epoch 1382 Loss: -0.25956;Gen: -3.25437;fit arb:  0.06588;lr: 0.00100; no_improve: 51
Save!Epoch 1450 Loss: -0.27830;Gen: -3.42529;fit arb:  0.06423;lr: 0.00100; no_improve: 67
Save!Epoch 1466 Loss: -0.26080;Gen: -3.24301;fit arb:  0.06350;lr: 0.00100; no_improve: 15
Save!Epoch 1947 Loss: -0.27018;Gen: -3.32968;fit arb:  0.06279;lr: 0.00100; no_improve: 480
Save!Epoch 1988 Loss: -0.27079;Gen: -3.32417;fit arb:  0.06163;lr: 0.00050; no_improve: 40
Epoch 2000 Loss: -0.26319;Gen: -3.45984;fit arb:  0.08279;lr: 0.00050;no_improve: 12
Save!Epoch 2006 Loss: -0.27712;Gen: -3.36993;fit arb:  0.05987;lr: 0.00050; no_improve: 17
Save!Epoch 2016 Loss: -0.27542;Gen: -3.34451;fit arb:  0.05903;lr: 0.00050; no_improve: 9
Save!Epoch 2080 Loss: -0.27703;Gen: -3.33484;fit arb:  0.05645;lr: 0.00050; no_improve: 63
Save!Epoch 2117 Loss: -0.27782;Gen: -3.33235;fit arb:  0.05542;lr: 0.00050; no_improve: 36
Save!Epoch 2182 Loss: -0.27853;Gen: -3.33264;fit arb:  0.05474;lr: 0.00050; no_improve: 64
Save!Epoch 2209 Loss: -0.28556;Gen: -3.38944;fit arb:  0.05338;lr: 0.00050; no_improve: 26
Save!Epoch 2300 Loss: -0.28459;Gen: -3.36343;fit arb:  0.05175;lr: 0.00050; no_improve: 90
Save!Epoch 2567 Loss: -0.28553;Gen: -3.34423;fit arb:  0.04889;lr: 0.00050; no_improve: 266
Save!Epoch 2684 Loss: -0.29182;Gen: -3.39864;fit arb:  0.04805;lr: 0.00050; no_improve: 116
Save!Epoch 2804 Loss: -0.28795;Gen: -3.35224;fit arb:  0.04727;lr: 0.00050; no_improve: 119
Epoch 3000 Loss: -0.27085;Gen: -3.39880;fit arb:  0.06903;lr: 0.00050;no_improve: 196
Save!Epoch 3061 Loss: -0.29364;Gen: -3.40007;fit arb:  0.04637;lr: 0.00050; no_improve: 256
Save!Epoch 3079 Loss: -0.29052;Gen: -3.35044;fit arb:  0.04452;lr: 0.00050; no_improve: 17
Save!Epoch 3576 Loss: -0.29357;Gen: -3.37387;fit arb:  0.04382;lr: 0.00050; no_improve: 496
Save!Epoch 3594 Loss: -0.28981;Gen: -3.33078;fit arb:  0.04327;lr: 0.00050; no_improve: 17
Save!Epoch 3794 Loss: -0.30064;Gen: -3.42288;fit arb:  0.04164;lr: 0.00050; no_improve: 199
Epoch 4000 Loss: -0.29184;Gen: -3.50092;fit arb:  0.05825;lr: 0.00050;no_improve: 206
Save!Epoch 4868 Loss: -0.29739;Gen: -3.38469;fit arb:  0.04108;lr: 0.00050; no_improve: 1073
Save!Epoch 4977 Loss: -0.30481;Gen: -3.45336;fit arb:  0.04052;lr: 0.00050; no_improve: 108
Epoch 5000 Loss: -0.28682;Gen: -3.45041;fit arb:  0.05822;lr: 0.00050;no_improve: 23
Save!Epoch 5844 Loss: -0.28445;Gen: -3.23317;fit arb:  0.03887;lr: 0.00050; no_improve: 866
Epoch 6000 Loss: -0.29161;Gen: -3.46538;fit arb:  0.05493;lr: 0.00050;no_improve: 156
Save!Epoch 6444 Loss: -0.29806;Gen: -3.35592;fit arb:  0.03753;lr: 0.00050; no_improve: 599
Epoch 7000 Loss: -0.28355;Gen: -3.42110;fit arb:  0.05856;lr: 0.00050;no_improve: 556
Save!Epoch 7402 Loss: -0.30221;Gen: -3.38938;fit arb:  0.03672;lr: 0.00025; no_improve: 957
Save!Epoch 7403 Loss: -0.30060;Gen: -3.36709;fit arb:  0.03611;lr: 0.00025; no_improve: 0
Save!Epoch 7442 Loss: -0.30410;Gen: -3.39751;fit arb:  0.03565;lr: 0.00025; no_improve: 38
Save!Epoch 7652 Loss: -0.30600;Gen: -3.40960;fit arb:  0.03496;lr: 0.00025; no_improve: 209
Epoch 8000 Loss: -0.30742;Gen: -3.45463;fit arb:  0.03804;lr: 0.00025;no_improve: 348
Save!Epoch 8560 Loss: -0.30014;Gen: -3.34214;fit arb:  0.03408;lr: 0.00025; no_improve: 907
Save!Epoch 8885 Loss: -0.30461;Gen: -3.38258;fit arb:  0.03365;lr: 0.00025; no_improve: 324
Epoch 9000 Loss: -0.29949;Gen: -3.45252;fit arb:  0.04576;lr: 0.00025;no_improve: 115
Save!Epoch 9129 Loss: -0.30543;Gen: -3.38313;fit arb:  0.03289;lr: 0.00025; no_improve: 243
Save!Epoch 9778 Loss: -0.30689;Gen: -3.39427;fit arb:  0.03254;lr: 0.00025; no_improve: 648
Save!Epoch 9913 Loss: -0.30486;Gen: -3.37041;fit arb:  0.03218;lr: 0.00025; no_improve: 134
Epoch 10000 Loss: -0.30232;Gen: -3.50588;fit arb:  0.04827;lr: 0.00025;no_improve: 87
Epoch 11000 Loss: -0.31533;Gen: -3.54409;fit arb:  0.03908;lr: 0.00025;no_improve: 1087
Save!Epoch 11450 Loss: -0.31463;Gen: -3.45996;fit arb:  0.03137;lr: 0.00025; no_improve: 1536
Epoch 12000 Loss: -0.30192;Gen: -3.35210;fit arb:  0.03329;lr: 0.00025;no_improve: 550
Save!Epoch 12612 Loss: -0.31099;Gen: -3.41940;fit arb:  0.03095;lr: 0.00025; no_improve: 1161
Epoch 13000 Loss: -0.31035;Gen: -3.50125;fit arb:  0.03977;lr: 0.00025;no_improve: 388
Save!Epoch 13156 Loss: -0.31671;Gen: -3.46733;fit arb:  0.03003;lr: 0.00025; no_improve: 543
Epoch 14000 Loss: -0.30640;Gen: -3.42888;fit arb:  0.03649;lr: 0.00025;no_improve: 844
Save!Epoch 14646 Loss: -0.31462;Gen: -3.44221;fit arb:  0.02960;lr: 0.00025; no_improve: 1489
Epoch 15000 Loss: -0.30152;Gen: -3.43416;fit arb:  0.04190;lr: 0.00025;no_improve: 354
Epoch 16000 Loss: -0.30727;Gen: -3.40572;fit arb:  0.03331;lr: 0.00025;no_improve: 1354
Epoch 17000 Loss: -0.30481;Gen: -3.43021;fit arb:  0.03821;lr: 0.00025;no_improve: 2354
Epoch 18000 Loss: -0.31575;Gen: -3.49084;fit arb:  0.03333;lr: 0.00013;no_improve: 3354
Save!Epoch 18004 Loss: -0.31326;Gen: -3.42164;fit arb:  0.02890;lr: 0.00013; no_improve: 3357
Epoch 19000 Loss: -0.31447;Gen: -3.50759;fit arb:  0.03629;lr: 0.00013;no_improve: 996
Save!Epoch 19572 Loss: -0.31763;Gen: -3.46072;fit arb:  0.02844;lr: 0.00013; no_improve: 1567
Epoch 20000 Loss: -0.31912;Gen: -3.50983;fit arb:  0.03186;lr: 0.00013;no_improve: 428

训练完成! 分钟: 2025-08-13 14:30:00, 划分方式: forecast

==========================================
训练结束时间: 2025-10-19 01:59:38
==========================================
