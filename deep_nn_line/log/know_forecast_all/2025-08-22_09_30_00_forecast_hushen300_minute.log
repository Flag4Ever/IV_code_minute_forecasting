==========================================
训练开始时间: 2025-10-19 06:09:55
分钟: 2025-08-22 09:30:00 | 划分: forecast | 设备: cuda
标记列: train_flag_inter
==========================================
加载数据: ../data/hushen300_minute/hushen300_minute.csv
筛选分钟: 2025-08-22 09:30:00
筛选后数据行数: 128
按照 train_flag_inter=1 筛选后数据行数: 128
加载初始化模型: ./checkpoint/know_forecast_all/hushen300_minute_forecast_clear/init_model/seed_1234_0.1_lr_0.001_gen_lr_0.001_w_d_0.0_best_model.pth
使用 torch.compile 优化模型 (设备: cuda)
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
Glow模型使用 CUDA
加载Glow模型: ../glow_nn_line/glow_nn_svi_2/model_500000.pt
使用 torch.compile 优化 Glow 模型
开始训练，总轮数: 20000, 第一阶段: 0
Save!Epoch 1 Loss: -0.17259;Gen: -3.00027;fit arb:  0.12744;lr: 0.00100; no_improve: 0
Save!Epoch 2 Loss: -0.22847;Gen: -3.24005;fit arb:  0.09553;lr: 0.00100; no_improve: 0
Save!Epoch 3 Loss: -0.26020;Gen: -3.39077;fit arb:  0.07888;lr: 0.00100; no_improve: 0
Save!Epoch 4 Loss: -0.26517;Gen: -3.41083;fit arb:  0.07591;lr: 0.00100; no_improve: 0
Save!Epoch 7 Loss: -0.29115;Gen: -3.65388;fit arb:  0.07424;lr: 0.00100; no_improve: 2
Save!Epoch 8 Loss: -0.31240;Gen: -3.67900;fit arb:  0.05550;lr: 0.00100; no_improve: 0
Save!Epoch 35 Loss: -0.32615;Gen: -3.76286;fit arb:  0.05013;lr: 0.00100; no_improve: 26
Save!Epoch 36 Loss: -0.32875;Gen: -3.75285;fit arb:  0.04654;lr: 0.00100; no_improve: 0
Save!Epoch 46 Loss: -0.33364;Gen: -3.78752;fit arb:  0.04512;lr: 0.00100; no_improve: 9
Save!Epoch 56 Loss: -0.33671;Gen: -3.79021;fit arb:  0.04231;lr: 0.00100; no_improve: 9
Save!Epoch 66 Loss: -0.34027;Gen: -3.82029;fit arb:  0.04176;lr: 0.00100; no_improve: 9
Epoch 1000 Loss: -0.31974;Gen: -3.79375;fit arb:  0.05964;lr: 0.00050;no_improve: 934
Save!Epoch 1223 Loss: -0.34801;Gen: -3.89100;fit arb:  0.04109;lr: 0.00050; no_improve: 1156
Save!Epoch 1308 Loss: -0.34328;Gen: -3.81290;fit arb:  0.03801;lr: 0.00050; no_improve: 84
Save!Epoch 1341 Loss: -0.34587;Gen: -3.82611;fit arb:  0.03674;lr: 0.00050; no_improve: 32
Save!Epoch 1425 Loss: -0.34983;Gen: -3.85394;fit arb:  0.03556;lr: 0.00050; no_improve: 83
Save!Epoch 1475 Loss: -0.35266;Gen: -3.87730;fit arb:  0.03507;lr: 0.00050; no_improve: 49
Save!Epoch 1492 Loss: -0.34629;Gen: -3.80665;fit arb:  0.03437;lr: 0.00050; no_improve: 16
Save!Epoch 1524 Loss: -0.35358;Gen: -3.87448;fit arb:  0.03387;lr: 0.00050; no_improve: 31
Save!Epoch 1541 Loss: -0.34960;Gen: -3.82643;fit arb:  0.03304;lr: 0.00050; no_improve: 16
Save!Epoch 1575 Loss: -0.34882;Gen: -3.80421;fit arb:  0.03160;lr: 0.00050; no_improve: 33
Save!Epoch 1592 Loss: -0.35668;Gen: -3.87876;fit arb:  0.03119;lr: 0.00050; no_improve: 16
Save!Epoch 1626 Loss: -0.35078;Gen: -3.81503;fit arb:  0.03073;lr: 0.00050; no_improve: 33
Save!Epoch 1812 Loss: -0.35026;Gen: -3.80406;fit arb:  0.03014;lr: 0.00050; no_improve: 185
Save!Epoch 1999 Loss: -0.35840;Gen: -3.87502;fit arb:  0.02910;lr: 0.00050; no_improve: 186
Epoch 2000 Loss: -0.34639;Gen: -3.78566;fit arb:  0.03218;lr: 0.00050;no_improve: 1
Save!Epoch 2203 Loss: -0.35326;Gen: -3.81411;fit arb:  0.02815;lr: 0.00050; no_improve: 203
Save!Epoch 2273 Loss: -0.35737;Gen: -3.84958;fit arb:  0.02759;lr: 0.00050; no_improve: 69
Epoch 3000 Loss: -0.35244;Gen: -3.83975;fit arb:  0.03154;lr: 0.00050;no_improve: 727
Save!Epoch 3068 Loss: -0.35643;Gen: -3.83697;fit arb:  0.02727;lr: 0.00050; no_improve: 794
Save!Epoch 3615 Loss: -0.35851;Gen: -3.85466;fit arb:  0.02695;lr: 0.00050; no_improve: 546
Save!Epoch 3919 Loss: -0.35325;Gen: -3.79454;fit arb:  0.02620;lr: 0.00050; no_improve: 303
Epoch 4000 Loss: -0.35629;Gen: -3.87878;fit arb:  0.03158;lr: 0.00050;no_improve: 81
Epoch 5000 Loss: -0.33832;Gen: -3.82985;fit arb:  0.04467;lr: 0.00050;no_improve: 1081
Save!Epoch 5073 Loss: -0.35436;Gen: -3.80208;fit arb:  0.02585;lr: 0.00050; no_improve: 1153
Save!Epoch 5459 Loss: -0.35614;Gen: -3.81136;fit arb:  0.02500;lr: 0.00050; no_improve: 385
Save!Epoch 5497 Loss: -0.36373;Gen: -3.87829;fit arb:  0.02410;lr: 0.00050; no_improve: 37
Epoch 6000 Loss: -0.35167;Gen: -3.89561;fit arb:  0.03789;lr: 0.00050;no_improve: 503
Epoch 7000 Loss: -0.33897;Gen: -3.84857;fit arb:  0.04589;lr: 0.00050;no_improve: 1503
Epoch 8000 Loss: -0.35359;Gen: -3.87802;fit arb:  0.03421;lr: 0.00050;no_improve: 2503
Epoch 9000 Loss: -0.35796;Gen: -3.85846;fit arb:  0.02788;lr: 0.00050;no_improve: 3503
Save!Epoch 9012 Loss: -0.35959;Gen: -3.83407;fit arb:  0.02382;lr: 0.00050; no_improve: 3514
Save!Epoch 9956 Loss: -0.36136;Gen: -3.84445;fit arb:  0.02308;lr: 0.00050; no_improve: 943
Epoch 10000 Loss: -0.36236;Gen: -3.87771;fit arb:  0.02541;lr: 0.00050;no_improve: 44
Save!Epoch 10021 Loss: -0.36069;Gen: -3.83278;fit arb:  0.02259;lr: 0.00050; no_improve: 64
Save!Epoch 10303 Loss: -0.36406;Gen: -3.86355;fit arb:  0.02229;lr: 0.00050; no_improve: 281
Save!Epoch 10800 Loss: -0.36491;Gen: -3.86949;fit arb:  0.02204;lr: 0.00050; no_improve: 496
Epoch 11000 Loss: -0.34534;Gen: -3.88120;fit arb:  0.04278;lr: 0.00050;no_improve: 200
Epoch 12000 Loss: -0.35829;Gen: -3.83897;fit arb:  0.02561;lr: 0.00050;no_improve: 1200
Save!Epoch 12593 Loss: -0.36177;Gen: -3.83087;fit arb:  0.02132;lr: 0.00050; no_improve: 1792
Epoch 13000 Loss: -0.35777;Gen: -3.89584;fit arb:  0.03181;lr: 0.00050;no_improve: 407
Save!Epoch 13014 Loss: -0.36330;Gen: -3.84104;fit arb:  0.02081;lr: 0.00050; no_improve: 420
Epoch 14000 Loss: -0.35909;Gen: -3.83122;fit arb:  0.02403;lr: 0.00050;no_improve: 986
Epoch 15000 Loss: -0.34220;Gen: -3.79637;fit arb:  0.03744;lr: 0.00050;no_improve: 1986
Epoch 16000 Loss: -0.34638;Gen: -3.80189;fit arb:  0.03381;lr: 0.00050;no_improve: 2986
Epoch 17000 Loss: -0.34999;Gen: -3.87820;fit arb:  0.03783;lr: 0.00050;no_improve: 3986
Restart!Epoch 17014 Loss: -0.34225;Gen: -3.83315;fit arb:  0.04106;lr: 0.00100;no_improve: 0
Save!Epoch 17059 Loss: -0.36345;Gen: -3.82515;fit arb:  0.01906;lr: 0.00100; no_improve: 44
Epoch 18000 Loss: -0.36096;Gen: -3.86770;fit arb:  0.02581;lr: 0.00050;no_improve: 941
Epoch 19000 Loss: -0.35278;Gen: -3.84109;fit arb:  0.03133;lr: 0.00050;no_improve: 1941
Save!Epoch 19110 Loss: -0.36425;Gen: -3.82604;fit arb:  0.01836;lr: 0.00050; no_improve: 2050
Save!Epoch 19729 Loss: -0.36885;Gen: -3.87025;fit arb:  0.01817;lr: 0.00050; no_improve: 618
Save!Epoch 19739 Loss: -0.36375;Gen: -3.81503;fit arb:  0.01776;lr: 0.00050; no_improve: 9
Epoch 20000 Loss: -0.35774;Gen: -3.88913;fit arb:  0.03117;lr: 0.00050;no_improve: 261

训练完成! 分钟: 2025-08-22 09:30:00, 划分方式: forecast

==========================================
训练结束时间: 2025-10-19 06:18:16
==========================================
