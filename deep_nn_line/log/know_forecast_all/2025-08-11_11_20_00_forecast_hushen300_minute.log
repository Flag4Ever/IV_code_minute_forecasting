==========================================
训练开始时间: 2025-10-19 00:04:04
分钟: 2025-08-11 11:20:00 | 划分: forecast | 设备: cuda
标记列: train_flag_inter
==========================================
加载数据: ../data/hushen300_minute/hushen300_minute.csv
筛选分钟: 2025-08-11 11:20:00
筛选后数据行数: 107
按照 train_flag_inter=1 筛选后数据行数: 107
加载初始化模型: ./checkpoint/know_forecast_all/hushen300_minute_forecast_clear/init_model/seed_1234_0.1_lr_0.001_gen_lr_0.001_w_d_0.0_best_model.pth
使用 torch.compile 优化模型 (设备: cuda)
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Glow模型使用 CUDA
加载Glow模型: ../glow_nn_line/glow_nn_svi_2/model_500000.pt
使用 torch.compile 优化 Glow 模型
开始训练，总轮数: 20000, 第一阶段: 0
Save!Epoch 1 Loss: -0.13251;Gen: -3.51503;fit arb:  0.21900;lr: 0.00100; no_improve: 0
Save!Epoch 2 Loss: -0.14601;Gen: -3.61866;fit arb:  0.21586;lr: 0.00100; no_improve: 0
Save!Epoch 3 Loss: -0.15018;Gen: -3.61633;fit arb:  0.21145;lr: 0.00100; no_improve: 0
Save!Epoch 4 Loss: -0.14790;Gen: -3.56345;fit arb:  0.20845;lr: 0.00100; no_improve: 0
Save!Epoch 9 Loss: -0.16765;Gen: -3.61676;fit arb:  0.19403;lr: 0.00100; no_improve: 4
Save!Epoch 10 Loss: -0.18063;Gen: -3.62995;fit arb:  0.18237;lr: 0.00100; no_improve: 0
Save!Epoch 15 Loss: -0.18736;Gen: -3.65953;fit arb:  0.17859;lr: 0.00100; no_improve: 4
Save!Epoch 16 Loss: -0.19171;Gen: -3.56787;fit arb:  0.16508;lr: 0.00100; no_improve: 0
Save!Epoch 17 Loss: -0.20635;Gen: -3.57374;fit arb:  0.15102;lr: 0.00100; no_improve: 0
Save!Epoch 18 Loss: -0.21223;Gen: -3.57730;fit arb:  0.14550;lr: 0.00100; no_improve: 0
Save!Epoch 25 Loss: -0.21522;Gen: -3.50756;fit arb:  0.13554;lr: 0.00100; no_improve: 6
Save!Epoch 26 Loss: -0.24487;Gen: -3.58684;fit arb:  0.11382;lr: 0.00100; no_improve: 0
Save!Epoch 27 Loss: -0.25515;Gen: -3.53932;fit arb:  0.09879;lr: 0.00100; no_improve: 0
Save!Epoch 36 Loss: -0.25132;Gen: -3.44526;fit arb:  0.09321;lr: 0.00100; no_improve: 8
Save!Epoch 44 Loss: -0.25580;Gen: -3.46629;fit arb:  0.09083;lr: 0.00100; no_improve: 7
Save!Epoch 45 Loss: -0.26840;Gen: -3.52138;fit arb:  0.08373;lr: 0.00100; no_improve: 0
Save!Epoch 53 Loss: -0.27733;Gen: -3.48561;fit arb:  0.07123;lr: 0.00100; no_improve: 7
Save!Epoch 54 Loss: -0.27799;Gen: -3.43216;fit arb:  0.06523;lr: 0.00100; no_improve: 0
Save!Epoch 62 Loss: -0.27952;Gen: -3.42596;fit arb:  0.06308;lr: 0.00100; no_improve: 7
Save!Epoch 63 Loss: -0.28454;Gen: -3.45377;fit arb:  0.06084;lr: 0.00100; no_improve: 0
Save!Epoch 102 Loss: -0.28456;Gen: -3.43527;fit arb:  0.05897;lr: 0.00100; no_improve: 38
Save!Epoch 103 Loss: -0.28818;Gen: -3.45181;fit arb:  0.05700;lr: 0.00100; no_improve: 0
Save!Epoch 119 Loss: -0.29336;Gen: -3.44687;fit arb:  0.05133;lr: 0.00100; no_improve: 15
Save!Epoch 254 Loss: -0.29752;Gen: -3.45827;fit arb:  0.04831;lr: 0.00100; no_improve: 134
Save!Epoch 709 Loss: -0.30675;Gen: -3.52711;fit arb:  0.04596;lr: 0.00100; no_improve: 454
Save!Epoch 958 Loss: -0.31298;Gen: -3.54660;fit arb:  0.04168;lr: 0.00100; no_improve: 248
Epoch 1000 Loss: -0.30529;Gen: -3.48875;fit arb:  0.04359;lr: 0.00100;no_improve: 42
Save!Epoch 1151 Loss: -0.31171;Gen: -3.49769;fit arb:  0.03806;lr: 0.00100; no_improve: 192
Epoch 2000 Loss: -0.29243;Gen: -3.58680;fit arb:  0.06625;lr: 0.00100;no_improve: 849
Save!Epoch 2183 Loss: -0.32305;Gen: -3.60639;fit arb:  0.03759;lr: 0.00100; no_improve: 1031
Save!Epoch 2307 Loss: -0.31745;Gen: -3.52890;fit arb:  0.03544;lr: 0.00100; no_improve: 123
Save!Epoch 2621 Loss: -0.32646;Gen: -3.59661;fit arb:  0.03320;lr: 0.00050; no_improve: 313
Save!Epoch 2630 Loss: -0.32654;Gen: -3.57188;fit arb:  0.03065;lr: 0.00050; no_improve: 8
Save!Epoch 2826 Loss: -0.33282;Gen: -3.62053;fit arb:  0.02924;lr: 0.00050; no_improve: 195
Epoch 3000 Loss: -0.31103;Gen: -3.58449;fit arb:  0.04742;lr: 0.00050;no_improve: 174
Save!Epoch 3442 Loss: -0.32977;Gen: -3.58205;fit arb:  0.02844;lr: 0.00050; no_improve: 615
Save!Epoch 3548 Loss: -0.33028;Gen: -3.58309;fit arb:  0.02803;lr: 0.00050; no_improve: 105
Epoch 4000 Loss: -0.33067;Gen: -3.61504;fit arb:  0.03083;lr: 0.00050;no_improve: 452
Save!Epoch 4880 Loss: -0.32400;Gen: -3.50000;fit arb:  0.02600;lr: 0.00050; no_improve: 1331
Epoch 5000 Loss: -0.30246;Gen: -3.57891;fit arb:  0.05543;lr: 0.00050;no_improve: 120
Epoch 6000 Loss: -0.32610;Gen: -3.62239;fit arb:  0.03614;lr: 0.00050;no_improve: 1120
Save!Epoch 6836 Loss: -0.33984;Gen: -3.64509;fit arb:  0.02467;lr: 0.00050; no_improve: 1955
Epoch 7000 Loss: -0.32078;Gen: -3.61655;fit arb:  0.04087;lr: 0.00050;no_improve: 164
Epoch 8000 Loss: -0.33769;Gen: -3.64823;fit arb:  0.02713;lr: 0.00025;no_improve: 1164
Epoch 9000 Loss: -0.32595;Gen: -3.63336;fit arb:  0.03739;lr: 0.00025;no_improve: 2164
Save!Epoch 9246 Loss: -0.33376;Gen: -3.57997;fit arb:  0.02424;lr: 0.00013; no_improve: 2409
Save!Epoch 9247 Loss: -0.34119;Gen: -3.64985;fit arb:  0.02380;lr: 0.00013; no_improve: 0
Save!Epoch 9271 Loss: -0.34059;Gen: -3.64101;fit arb:  0.02351;lr: 0.00013; no_improve: 23
Save!Epoch 9369 Loss: -0.34156;Gen: -3.64788;fit arb:  0.02323;lr: 0.00013; no_improve: 97
Save!Epoch 9370 Loss: -0.33749;Gen: -3.60368;fit arb:  0.02288;lr: 0.00013; no_improve: 0
Save!Epoch 9565 Loss: -0.34134;Gen: -3.63568;fit arb:  0.02223;lr: 0.00013; no_improve: 194
Save!Epoch 9737 Loss: -0.33939;Gen: -3.61126;fit arb:  0.02174;lr: 0.00013; no_improve: 171
Save!Epoch 9813 Loss: -0.34104;Gen: -3.62404;fit arb:  0.02137;lr: 0.00013; no_improve: 75
Epoch 10000 Loss: -0.34325;Gen: -3.67166;fit arb:  0.02392;lr: 0.00013;no_improve: 187
Save!Epoch 10282 Loss: -0.33854;Gen: -3.59681;fit arb:  0.02114;lr: 0.00013; no_improve: 468
Save!Epoch 10661 Loss: -0.34388;Gen: -3.64637;fit arb:  0.02076;lr: 0.00013; no_improve: 378
Epoch 11000 Loss: -0.34159;Gen: -3.67630;fit arb:  0.02604;lr: 0.00013;no_improve: 339
Epoch 12000 Loss: -0.33410;Gen: -3.60267;fit arb:  0.02617;lr: 0.00013;no_improve: 1339
Save!Epoch 12782 Loss: -0.33909;Gen: -3.59564;fit arb:  0.02047;lr: 0.00013; no_improve: 2120
Epoch 13000 Loss: -0.34496;Gen: -3.67151;fit arb:  0.02219;lr: 0.00013;no_improve: 218
Epoch 14000 Loss: -0.33341;Gen: -3.59380;fit arb:  0.02597;lr: 0.00013;no_improve: 1218
Save!Epoch 14063 Loss: -0.34281;Gen: -3.62671;fit arb:  0.01986;lr: 0.00013; no_improve: 1280
Epoch 15000 Loss: -0.33580;Gen: -3.56344;fit arb:  0.02054;lr: 0.00013;no_improve: 937
Save!Epoch 15909 Loss: -0.34422;Gen: -3.63753;fit arb:  0.01953;lr: 0.00013; no_improve: 1845
Epoch 16000 Loss: -0.33274;Gen: -3.57372;fit arb:  0.02463;lr: 0.00013;no_improve: 91
Save!Epoch 16878 Loss: -0.34740;Gen: -3.66539;fit arb:  0.01914;lr: 0.00013; no_improve: 968
Epoch 17000 Loss: -0.34074;Gen: -3.65887;fit arb:  0.02515;lr: 0.00013;no_improve: 122
Save!Epoch 17528 Loss: -0.34901;Gen: -3.67879;fit arb:  0.01887;lr: 0.00013; no_improve: 649
Epoch 18000 Loss: -0.34385;Gen: -3.66929;fit arb:  0.02308;lr: 0.00013;no_improve: 472
Save!Epoch 18266 Loss: -0.35158;Gen: -3.70084;fit arb:  0.01851;lr: 0.00013; no_improve: 737
Save!Epoch 18441 Loss: -0.34525;Gen: -3.63568;fit arb:  0.01832;lr: 0.00013; no_improve: 174
Save!Epoch 18885 Loss: -0.34487;Gen: -3.62988;fit arb:  0.01812;lr: 0.00013; no_improve: 443
Epoch 19000 Loss: -0.34271;Gen: -3.62154;fit arb:  0.01945;lr: 0.00013;no_improve: 115
Epoch 20000 Loss: -0.34288;Gen: -3.66538;fit arb:  0.02366;lr: 0.00013;no_improve: 1115

训练完成! 分钟: 2025-08-11 11:20:00, 划分方式: forecast

==========================================
训练结束时间: 2025-10-19 00:10:19
==========================================
