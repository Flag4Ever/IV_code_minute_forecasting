==========================================
训练开始时间: 2025-10-19 04:14:36
分钟: 2025-08-18 13:30:00 | 划分: forecast | 设备: cuda
标记列: train_flag_inter
==========================================
加载数据: ../data/hushen300_minute/hushen300_minute.csv
筛选分钟: 2025-08-18 13:30:00
筛选后数据行数: 106
按照 train_flag_inter=1 筛选后数据行数: 106
加载初始化模型: ./checkpoint/know_forecast_all/hushen300_minute_forecast_clear/init_model/seed_1234_0.1_lr_0.001_gen_lr_0.001_w_d_0.0_best_model.pth
使用 torch.compile 优化模型 (设备: cuda)
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Glow模型使用 CUDA
加载Glow模型: ../glow_nn_line/glow_nn_svi_2/model_500000.pt
使用 torch.compile 优化 Glow 模型
开始训练，总轮数: 20000, 第一阶段: 0
Save!Epoch 1 Loss: -0.17827;Gen: -3.32710;fit arb:  0.15444;lr: 0.00100; no_improve: 0
Save!Epoch 2 Loss: -0.22352;Gen: -3.50394;fit arb:  0.12687;lr: 0.00100; no_improve: 0
Save!Epoch 3 Loss: -0.25020;Gen: -3.55009;fit arb:  0.10480;lr: 0.00100; no_improve: 0
Save!Epoch 4 Loss: -0.26275;Gen: -3.52174;fit arb:  0.08943;lr: 0.00100; no_improve: 0
Save!Epoch 9 Loss: -0.28162;Gen: -3.69296;fit arb:  0.08767;lr: 0.00100; no_improve: 4
Save!Epoch 10 Loss: -0.29519;Gen: -3.65885;fit arb:  0.07070;lr: 0.00100; no_improve: 0
Save!Epoch 11 Loss: -0.30916;Gen: -3.75430;fit arb:  0.06627;lr: 0.00100; no_improve: 0
Save!Epoch 20 Loss: -0.31877;Gen: -3.77257;fit arb:  0.05849;lr: 0.00100; no_improve: 8
Save!Epoch 21 Loss: -0.32802;Gen: -3.74867;fit arb:  0.04685;lr: 0.00100; no_improve: 0
Save!Epoch 103 Loss: -0.33243;Gen: -3.78504;fit arb:  0.04607;lr: 0.00100; no_improve: 81
Save!Epoch 104 Loss: -0.34056;Gen: -3.85661;fit arb:  0.04510;lr: 0.00100; no_improve: 0
Save!Epoch 114 Loss: -0.34009;Gen: -3.80052;fit arb:  0.03997;lr: 0.00100; no_improve: 9
Save!Epoch 133 Loss: -0.34070;Gen: -3.80051;fit arb:  0.03936;lr: 0.00100; no_improve: 18
Save!Epoch 134 Loss: -0.34495;Gen: -3.82180;fit arb:  0.03723;lr: 0.00100; no_improve: 0
Epoch 1000 Loss: -0.33530;Gen: -3.82962;fit arb:  0.04766;lr: 0.00050;no_improve: 866
Save!Epoch 1383 Loss: -0.35064;Gen: -3.87365;fit arb:  0.03673;lr: 0.00050; no_improve: 1248
Save!Epoch 1392 Loss: -0.35347;Gen: -3.89297;fit arb:  0.03582;lr: 0.00050; no_improve: 8
Save!Epoch 1393 Loss: -0.35191;Gen: -3.86278;fit arb:  0.03437;lr: 0.00050; no_improve: 0
Save!Epoch 1570 Loss: -0.35363;Gen: -3.87220;fit arb:  0.03359;lr: 0.00050; no_improve: 176
Save!Epoch 1605 Loss: -0.35023;Gen: -3.82798;fit arb:  0.03257;lr: 0.00050; no_improve: 34
Save!Epoch 1658 Loss: -0.35715;Gen: -3.88436;fit arb:  0.03129;lr: 0.00050; no_improve: 52
Save!Epoch 1905 Loss: -0.35667;Gen: -3.86502;fit arb:  0.02983;lr: 0.00050; no_improve: 246
Epoch 2000 Loss: -0.34697;Gen: -3.82112;fit arb:  0.03514;lr: 0.00050;no_improve: 95
Save!Epoch 2355 Loss: -0.36056;Gen: -3.89305;fit arb:  0.02875;lr: 0.00050; no_improve: 449
Save!Epoch 2409 Loss: -0.35795;Gen: -3.85981;fit arb:  0.02803;lr: 0.00050; no_improve: 53
Save!Epoch 2461 Loss: -0.35810;Gen: -3.85622;fit arb:  0.02752;lr: 0.00050; no_improve: 51
Save!Epoch 2591 Loss: -0.35885;Gen: -3.86029;fit arb:  0.02718;lr: 0.00050; no_improve: 129
Save!Epoch 2687 Loss: -0.35729;Gen: -3.83705;fit arb:  0.02641;lr: 0.00050; no_improve: 95
Save!Epoch 2898 Loss: -0.35679;Gen: -3.81920;fit arb:  0.02513;lr: 0.00050; no_improve: 210
Epoch 3000 Loss: -0.34987;Gen: -3.86736;fit arb:  0.03687;lr: 0.00050;no_improve: 102
Epoch 4000 Loss: -0.35325;Gen: -3.87578;fit arb:  0.03433;lr: 0.00050;no_improve: 1102
Save!Epoch 4055 Loss: -0.36125;Gen: -3.84586;fit arb:  0.02334;lr: 0.00050; no_improve: 1156
Epoch 5000 Loss: -0.35971;Gen: -3.86005;fit arb:  0.02630;lr: 0.00050;no_improve: 945
Save!Epoch 5333 Loss: -0.36184;Gen: -3.84820;fit arb:  0.02298;lr: 0.00050; no_improve: 1277
Save!Epoch 5773 Loss: -0.36837;Gen: -3.90483;fit arb:  0.02212;lr: 0.00050; no_improve: 439
Epoch 6000 Loss: -0.34978;Gen: -3.91719;fit arb:  0.04194;lr: 0.00050;no_improve: 227
Epoch 7000 Loss: -0.35790;Gen: -3.88450;fit arb:  0.03055;lr: 0.00050;no_improve: 1227
Epoch 8000 Loss: -0.36113;Gen: -3.93208;fit arb:  0.03208;lr: 0.00050;no_improve: 2227
Save!Epoch 8800 Loss: -0.36721;Gen: -3.88198;fit arb:  0.02099;lr: 0.00050; no_improve: 3026
Epoch 9000 Loss: -0.36790;Gen: -3.90726;fit arb:  0.02282;lr: 0.00050;no_improve: 200
Save!Epoch 9636 Loss: -0.36539;Gen: -3.85849;fit arb:  0.02046;lr: 0.00050; no_improve: 835
Save!Epoch 9681 Loss: -0.36793;Gen: -3.88105;fit arb:  0.02017;lr: 0.00050; no_improve: 44
Epoch 10000 Loss: -0.36274;Gen: -3.89224;fit arb:  0.02648;lr: 0.00050;no_improve: 319
Epoch 11000 Loss: -0.35807;Gen: -3.90581;fit arb:  0.03251;lr: 0.00050;no_improve: 1319
Epoch 12000 Loss: -0.36461;Gen: -3.85907;fit arb:  0.02130;lr: 0.00050;no_improve: 2319
Save!Epoch 12625 Loss: -0.37030;Gen: -3.90045;fit arb:  0.01974;lr: 0.00050; no_improve: 2943
Epoch 13000 Loss: -0.35706;Gen: -3.92181;fit arb:  0.03512;lr: 0.00050;no_improve: 375
Save!Epoch 13519 Loss: -0.37185;Gen: -3.89985;fit arb:  0.01813;lr: 0.00050; no_improve: 893
Epoch 14000 Loss: -0.35611;Gen: -3.83956;fit arb:  0.02784;lr: 0.00050;no_improve: 481
Epoch 15000 Loss: -0.35750;Gen: -3.79683;fit arb:  0.02218;lr: 0.00050;no_improve: 1481
Epoch 16000 Loss: -0.35300;Gen: -3.84229;fit arb:  0.03123;lr: 0.00050;no_improve: 2481
Save!Epoch 16916 Loss: -0.37062;Gen: -3.88200;fit arb:  0.01758;lr: 0.00050; no_improve: 3396
Epoch 17000 Loss: -0.36237;Gen: -3.87708;fit arb:  0.02534;lr: 0.00050;no_improve: 84
Epoch 18000 Loss: -0.36408;Gen: -3.89479;fit arb:  0.02540;lr: 0.00050;no_improve: 1084
Epoch 19000 Loss: -0.36674;Gen: -3.86890;fit arb:  0.02015;lr: 0.00050;no_improve: 2084
Epoch 20000 Loss: -0.36761;Gen: -3.89248;fit arb:  0.02163;lr: 0.00050;no_improve: 3084

训练完成! 分钟: 2025-08-18 13:30:00, 划分方式: forecast

==========================================
训练结束时间: 2025-10-19 04:23:01
==========================================
