==========================================
训练开始时间: 2025-10-19 10:43:09
分钟: 2025-08-29 11:20:00 | 划分: forecast | 设备: cuda
标记列: train_flag_inter
==========================================
加载数据: ../data/hushen300_minute/hushen300_minute.csv
筛选分钟: 2025-08-29 11:20:00
筛选后数据行数: 146
按照 train_flag_inter=1 筛选后数据行数: 146
加载初始化模型: ./checkpoint/know_forecast_all/hushen300_minute_forecast_clear/init_model/seed_1234_0.1_lr_0.001_gen_lr_0.001_w_d_0.0_best_model.pth
使用 torch.compile 优化模型 (设备: cuda)
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
Glow模型使用 CUDA
加载Glow模型: ../glow_nn_line/glow_nn_svi_2/model_500000.pt
使用 torch.compile 优化 Glow 模型
开始训练，总轮数: 20000, 第一阶段: 0
Save!Epoch 1 Loss: -0.10471;Gen: -3.21586;fit arb:  0.21687;lr: 0.00100; no_improve: 0
Save!Epoch 2 Loss: -0.15007;Gen: -3.33143;fit arb:  0.18308;lr: 0.00100; no_improve: 0
Save!Epoch 3 Loss: -0.18660;Gen: -3.45005;fit arb:  0.15840;lr: 0.00100; no_improve: 0
Save!Epoch 4 Loss: -0.19975;Gen: -3.43176;fit arb:  0.14342;lr: 0.00100; no_improve: 0
Save!Epoch 5 Loss: -0.21407;Gen: -3.44714;fit arb:  0.13064;lr: 0.00100; no_improve: 0
Save!Epoch 6 Loss: -0.23237;Gen: -3.60191;fit arb:  0.12782;lr: 0.00100; no_improve: 0
Save!Epoch 11 Loss: -0.25570;Gen: -3.69656;fit arb:  0.11395;lr: 0.00100; no_improve: 4
Save!Epoch 12 Loss: -0.26936;Gen: -3.68267;fit arb:  0.09891;lr: 0.00100; no_improve: 0
Save!Epoch 13 Loss: -0.28285;Gen: -3.70974;fit arb:  0.08812;lr: 0.00100; no_improve: 0
Save!Epoch 23 Loss: -0.29879;Gen: -3.82392;fit arb:  0.08360;lr: 0.00100; no_improve: 9
Save!Epoch 24 Loss: -0.29948;Gen: -3.80180;fit arb:  0.08070;lr: 0.00100; no_improve: 0
Save!Epoch 33 Loss: -0.30861;Gen: -3.79035;fit arb:  0.07043;lr: 0.00100; no_improve: 8
Save!Epoch 34 Loss: -0.30967;Gen: -3.76154;fit arb:  0.06648;lr: 0.00100; no_improve: 0
Save!Epoch 44 Loss: -0.31509;Gen: -3.74332;fit arb:  0.05924;lr: 0.00100; no_improve: 9
Save!Epoch 45 Loss: -0.33229;Gen: -3.81981;fit arb:  0.04970;lr: 0.00100; no_improve: 0
Save!Epoch 110 Loss: -0.33121;Gen: -3.79710;fit arb:  0.04850;lr: 0.00100; no_improve: 64
Save!Epoch 120 Loss: -0.32942;Gen: -3.76191;fit arb:  0.04677;lr: 0.00100; no_improve: 9
Epoch 1000 Loss: -0.31682;Gen: -3.83044;fit arb:  0.06622;lr: 0.00050;no_improve: 880
Save!Epoch 1485 Loss: -0.33794;Gen: -3.84040;fit arb:  0.04610;lr: 0.00050; no_improve: 1364
Save!Epoch 1503 Loss: -0.34527;Gen: -3.90264;fit arb:  0.04499;lr: 0.00050; no_improve: 17
Save!Epoch 1756 Loss: -0.34153;Gen: -3.85905;fit arb:  0.04437;lr: 0.00050; no_improve: 252
Save!Epoch 1792 Loss: -0.34318;Gen: -3.86580;fit arb:  0.04340;lr: 0.00050; no_improve: 35
Save!Epoch 1845 Loss: -0.34437;Gen: -3.86813;fit arb:  0.04244;lr: 0.00050; no_improve: 52
Save!Epoch 1863 Loss: -0.34685;Gen: -3.88698;fit arb:  0.04185;lr: 0.00050; no_improve: 17
Save!Epoch 1968 Loss: -0.34380;Gen: -3.84127;fit arb:  0.04033;lr: 0.00050; no_improve: 104
Epoch 2000 Loss: -0.32304;Gen: -3.85418;fit arb:  0.06238;lr: 0.00050;no_improve: 32
Save!Epoch 2056 Loss: -0.34710;Gen: -3.86759;fit arb:  0.03966;lr: 0.00050; no_improve: 87
Save!Epoch 2211 Loss: -0.34769;Gen: -3.86908;fit arb:  0.03921;lr: 0.00050; no_improve: 154
Save!Epoch 2281 Loss: -0.34989;Gen: -3.87569;fit arb:  0.03768;lr: 0.00050; no_improve: 69
Save!Epoch 2439 Loss: -0.34527;Gen: -3.81924;fit arb:  0.03665;lr: 0.00050; no_improve: 157
Save!Epoch 2440 Loss: -0.34787;Gen: -3.84065;fit arb:  0.03619;lr: 0.00050; no_improve: 0
Epoch 3000 Loss: -0.33320;Gen: -3.88541;fit arb:  0.05534;lr: 0.00050;no_improve: 560
Save!Epoch 3317 Loss: -0.34932;Gen: -3.84984;fit arb:  0.03567;lr: 0.00050; no_improve: 876
Save!Epoch 3372 Loss: -0.35029;Gen: -3.84620;fit arb:  0.03433;lr: 0.00050; no_improve: 54
Epoch 4000 Loss: -0.35238;Gen: -3.89430;fit arb:  0.03705;lr: 0.00050;no_improve: 628
Save!Epoch 4571 Loss: -0.35343;Gen: -3.87115;fit arb:  0.03369;lr: 0.00050; no_improve: 1198
Save!Epoch 4806 Loss: -0.35986;Gen: -3.92202;fit arb:  0.03235;lr: 0.00050; no_improve: 234
Epoch 5000 Loss: -0.33440;Gen: -3.91607;fit arb:  0.05720;lr: 0.00050;no_improve: 194
Save!Epoch 5563 Loss: -0.35687;Gen: -3.88740;fit arb:  0.03187;lr: 0.00050; no_improve: 756
Epoch 6000 Loss: -0.34877;Gen: -3.90573;fit arb:  0.04181;lr: 0.00050;no_improve: 437
Save!Epoch 6915 Loss: -0.35613;Gen: -3.87438;fit arb:  0.03131;lr: 0.00050; no_improve: 1351
Epoch 7000 Loss: -0.35176;Gen: -3.88140;fit arb:  0.03638;lr: 0.00050;no_improve: 85
Save!Epoch 7376 Loss: -0.35751;Gen: -3.88080;fit arb:  0.03057;lr: 0.00050; no_improve: 460
Epoch 8000 Loss: -0.34564;Gen: -3.90556;fit arb:  0.04492;lr: 0.00050;no_improve: 624
Epoch 9000 Loss: -0.33945;Gen: -3.88320;fit arb:  0.04887;lr: 0.00050;no_improve: 1624
Epoch 10000 Loss: -0.35944;Gen: -3.89977;fit arb:  0.03054;lr: 0.00050;no_improve: 2624
Save!Epoch 10078 Loss: -0.35963;Gen: -3.89870;fit arb:  0.03024;lr: 0.00050; no_improve: 2701
Save!Epoch 10737 Loss: -0.36274;Gen: -3.91867;fit arb:  0.02913;lr: 0.00050; no_improve: 658
Epoch 11000 Loss: -0.35087;Gen: -3.94459;fit arb:  0.04359;lr: 0.00050;no_improve: 263
Save!Epoch 11876 Loss: -0.36274;Gen: -3.90993;fit arb:  0.02825;lr: 0.00050; no_improve: 1138
Epoch 12000 Loss: -0.35648;Gen: -3.89387;fit arb:  0.03291;lr: 0.00050;no_improve: 124
Save!Epoch 12123 Loss: -0.36134;Gen: -3.87898;fit arb:  0.02656;lr: 0.00050; no_improve: 246
Epoch 13000 Loss: -0.35270;Gen: -3.92158;fit arb:  0.03946;lr: 0.00050;no_improve: 877
Epoch 14000 Loss: -0.35378;Gen: -3.87669;fit arb:  0.03389;lr: 0.00050;no_improve: 1877
Epoch 15000 Loss: -0.34349;Gen: -3.83656;fit arb:  0.04017;lr: 0.00050;no_improve: 2877
Epoch 16000 Loss: -0.35295;Gen: -3.85487;fit arb:  0.03253;lr: 0.00050;no_improve: 3877
Restart!Epoch 16123 Loss: -0.34163;Gen: -3.85535;fit arb:  0.04391;lr: 0.00100;no_improve: 0
Epoch 17000 Loss: -0.34470;Gen: -3.89207;fit arb:  0.04451;lr: 0.00050;no_improve: 877
Epoch 18000 Loss: -0.34615;Gen: -3.88442;fit arb:  0.04229;lr: 0.00050;no_improve: 1877
Epoch 19000 Loss: -0.35738;Gen: -3.88865;fit arb:  0.03148;lr: 0.00050;no_improve: 2877
Epoch 20000 Loss: -0.36150;Gen: -3.92409;fit arb:  0.03091;lr: 0.00050;no_improve: 3877

训练完成! 分钟: 2025-08-29 11:20:00, 划分方式: forecast

==========================================
训练结束时间: 2025-10-19 10:49:35
==========================================
