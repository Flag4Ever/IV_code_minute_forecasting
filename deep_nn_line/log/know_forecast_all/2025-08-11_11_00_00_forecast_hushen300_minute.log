==========================================
训练开始时间: 2025-10-18 23:56:22
分钟: 2025-08-11 11:00:00 | 划分: forecast | 设备: cuda
标记列: train_flag_inter
==========================================
加载数据: ../data/hushen300_minute/hushen300_minute.csv
筛选分钟: 2025-08-11 11:00:00
筛选后数据行数: 120
按照 train_flag_inter=1 筛选后数据行数: 120
加载初始化模型: ./checkpoint/know_forecast_all/hushen300_minute_forecast_clear/init_model/seed_1234_0.1_lr_0.001_gen_lr_0.001_w_d_0.0_best_model.pth
使用 torch.compile 优化模型 (设备: cuda)
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Glow模型使用 CUDA
加载Glow模型: ../glow_nn_line/glow_nn_svi_2/model_500000.pt
使用 torch.compile 优化 Glow 模型
开始训练，总轮数: 20000, 第一阶段: 0
Save!Epoch 1 Loss: -0.15601;Gen: -3.57118;fit arb:  0.20111;lr: 0.00100; no_improve: 0
Save!Epoch 3 Loss: -0.17225;Gen: -3.65538;fit arb:  0.19329;lr: 0.00100; no_improve: 1
Save!Epoch 8 Loss: -0.19355;Gen: -3.73119;fit arb:  0.17957;lr: 0.00100; no_improve: 4
Save!Epoch 14 Loss: -0.19083;Gen: -3.59059;fit arb:  0.16823;lr: 0.00100; no_improve: 5
Save!Epoch 15 Loss: -0.21430;Gen: -3.66685;fit arb:  0.15239;lr: 0.00100; no_improve: 0
Save!Epoch 16 Loss: -0.21739;Gen: -3.60076;fit arb:  0.14268;lr: 0.00100; no_improve: 0
Save!Epoch 23 Loss: -0.21394;Gen: -3.52545;fit arb:  0.13861;lr: 0.00100; no_improve: 6
Save!Epoch 24 Loss: -0.23702;Gen: -3.53684;fit arb:  0.11667;lr: 0.00100; no_improve: 0
Save!Epoch 25 Loss: -0.25295;Gen: -3.51879;fit arb:  0.09893;lr: 0.00100; no_improve: 0
Save!Epoch 26 Loss: -0.26119;Gen: -3.56805;fit arb:  0.09561;lr: 0.00100; no_improve: 0
Save!Epoch 44 Loss: -0.24976;Gen: -3.43183;fit arb:  0.09342;lr: 0.00100; no_improve: 17
Save!Epoch 52 Loss: -0.27496;Gen: -3.63867;fit arb:  0.08891;lr: 0.00100; no_improve: 7
Save!Epoch 53 Loss: -0.27950;Gen: -3.59606;fit arb:  0.08010;lr: 0.00100; no_improve: 0
Save!Epoch 62 Loss: -0.27527;Gen: -3.43117;fit arb:  0.06784;lr: 0.00100; no_improve: 8
Save!Epoch 108 Loss: -0.28714;Gen: -3.48623;fit arb:  0.06149;lr: 0.00100; no_improve: 45
Save!Epoch 117 Loss: -0.29301;Gen: -3.52096;fit arb:  0.05908;lr: 0.00100; no_improve: 8
Save!Epoch 268 Loss: -0.29548;Gen: -3.53281;fit arb:  0.05780;lr: 0.00100; no_improve: 150
Save!Epoch 326 Loss: -0.29831;Gen: -3.53257;fit arb:  0.05495;lr: 0.00100; no_improve: 57
Save!Epoch 374 Loss: -0.29918;Gen: -3.53170;fit arb:  0.05399;lr: 0.00100; no_improve: 47
Save!Epoch 375 Loss: -0.30074;Gen: -3.51716;fit arb:  0.05097;lr: 0.00100; no_improve: 0
Save!Epoch 461 Loss: -0.30902;Gen: -3.54844;fit arb:  0.04582;lr: 0.00100; no_improve: 85
Save!Epoch 743 Loss: -0.30511;Gen: -3.49091;fit arb:  0.04399;lr: 0.00100; no_improve: 281
Epoch 1000 Loss: -0.28689;Gen: -3.55869;fit arb:  0.06898;lr: 0.00100;no_improve: 257
Save!Epoch 1882 Loss: -0.31353;Gen: -3.56740;fit arb:  0.04321;lr: 0.00100; no_improve: 1138
Save!Epoch 1945 Loss: -0.31776;Gen: -3.58642;fit arb:  0.04088;lr: 0.00100; no_improve: 62
Save!Epoch 1946 Loss: -0.30778;Gen: -3.48200;fit arb:  0.04042;lr: 0.00100; no_improve: 0
Epoch 2000 Loss: -0.30421;Gen: -3.56886;fit arb:  0.05267;lr: 0.00100;no_improve: 54
Save!Epoch 2017 Loss: -0.31869;Gen: -3.58263;fit arb:  0.03957;lr: 0.00100; no_improve: 70
Save!Epoch 2295 Loss: -0.31680;Gen: -3.55521;fit arb:  0.03872;lr: 0.00100; no_improve: 277
Save!Epoch 2469 Loss: -0.32835;Gen: -3.65735;fit arb:  0.03738;lr: 0.00100; no_improve: 173
Save!Epoch 2822 Loss: -0.32312;Gen: -3.59632;fit arb:  0.03651;lr: 0.00100; no_improve: 352
Save!Epoch 2905 Loss: -0.32551;Gen: -3.61575;fit arb:  0.03607;lr: 0.00100; no_improve: 82
Save!Epoch 2947 Loss: -0.32262;Gen: -3.57331;fit arb:  0.03471;lr: 0.00100; no_improve: 41
Epoch 3000 Loss: -0.30625;Gen: -3.62150;fit arb:  0.05590;lr: 0.00100;no_improve: 53
Save!Epoch 3023 Loss: -0.32719;Gen: -3.61456;fit arb:  0.03426;lr: 0.00100; no_improve: 75
Save!Epoch 3071 Loss: -0.33484;Gen: -3.63070;fit arb:  0.02823;lr: 0.00100; no_improve: 47
Save!Epoch 3824 Loss: -0.33205;Gen: -3.58706;fit arb:  0.02666;lr: 0.00050; no_improve: 752
Save!Epoch 3954 Loss: -0.33438;Gen: -3.59951;fit arb:  0.02557;lr: 0.00050; no_improve: 129
Epoch 4000 Loss: -0.33414;Gen: -3.61868;fit arb:  0.02772;lr: 0.00050;no_improve: 46
Save!Epoch 4142 Loss: -0.33199;Gen: -3.56138;fit arb:  0.02414;lr: 0.00050; no_improve: 187
Epoch 5000 Loss: -0.32325;Gen: -3.62297;fit arb:  0.03904;lr: 0.00050;no_improve: 858
Save!Epoch 5896 Loss: -0.33678;Gen: -3.60546;fit arb:  0.02376;lr: 0.00050; no_improve: 1753
Epoch 6000 Loss: -0.33002;Gen: -3.67245;fit arb:  0.03722;lr: 0.00050;no_improve: 104
Epoch 7000 Loss: -0.32680;Gen: -3.61406;fit arb:  0.03460;lr: 0.00025;no_improve: 1104
Save!Epoch 7201 Loss: -0.33783;Gen: -3.60312;fit arb:  0.02248;lr: 0.00025; no_improve: 1304
Epoch 8000 Loss: -0.31288;Gen: -3.61886;fit arb:  0.04901;lr: 0.00025;no_improve: 799
Epoch 9000 Loss: -0.31689;Gen: -3.59983;fit arb:  0.04310;lr: 0.00025;no_improve: 1799
Epoch 10000 Loss: -0.32474;Gen: -3.66412;fit arb:  0.04167;lr: 0.00025;no_improve: 2799
Save!Epoch 10811 Loss: -0.34041;Gen: -3.62418;fit arb:  0.02201;lr: 0.00025; no_improve: 3609
Epoch 11000 Loss: -0.34117;Gen: -3.66971;fit arb:  0.02581;lr: 0.00025;no_improve: 189
Epoch 12000 Loss: -0.32463;Gen: -3.61692;fit arb:  0.03706;lr: 0.00025;no_improve: 1189
Save!Epoch 12446 Loss: -0.33717;Gen: -3.58308;fit arb:  0.02114;lr: 0.00025; no_improve: 1634
Epoch 13000 Loss: -0.32962;Gen: -3.69284;fit arb:  0.03966;lr: 0.00025;no_improve: 554
Save!Epoch 13245 Loss: -0.34337;Gen: -3.63721;fit arb:  0.02035;lr: 0.00025; no_improve: 798
Save!Epoch 13363 Loss: -0.34516;Gen: -3.64909;fit arb:  0.01975;lr: 0.00025; no_improve: 117
Epoch 14000 Loss: -0.32838;Gen: -3.59188;fit arb:  0.03081;lr: 0.00025;no_improve: 637
Epoch 15000 Loss: -0.33325;Gen: -3.61201;fit arb:  0.02795;lr: 0.00025;no_improve: 1637
Save!Epoch 15094 Loss: -0.34523;Gen: -3.64704;fit arb:  0.01947;lr: 0.00025; no_improve: 1730
Save!Epoch 15511 Loss: -0.34800;Gen: -3.67203;fit arb:  0.01920;lr: 0.00025; no_improve: 416
Save!Epoch 15531 Loss: -0.34291;Gen: -3.61578;fit arb:  0.01867;lr: 0.00025; no_improve: 19
Save!Epoch 15552 Loss: -0.34574;Gen: -3.64151;fit arb:  0.01842;lr: 0.00025; no_improve: 20
Epoch 16000 Loss: -0.33751;Gen: -3.56972;fit arb:  0.01946;lr: 0.00025;no_improve: 448
Save!Epoch 16038 Loss: -0.34599;Gen: -3.64159;fit arb:  0.01817;lr: 0.00025; no_improve: 485
Epoch 17000 Loss: -0.33408;Gen: -3.66706;fit arb:  0.03263;lr: 0.00025;no_improve: 962
Epoch 18000 Loss: -0.33078;Gen: -3.66558;fit arb:  0.03578;lr: 0.00025;no_improve: 1962
Epoch 19000 Loss: -0.33648;Gen: -3.64835;fit arb:  0.02835;lr: 0.00025;no_improve: 2962
Epoch 20000 Loss: -0.34496;Gen: -3.66961;fit arb:  0.02200;lr: 0.00025;no_improve: 3962

训练完成! 分钟: 2025-08-11 11:00:00, 划分方式: forecast

==========================================
训练结束时间: 2025-10-19 00:04:04
==========================================
