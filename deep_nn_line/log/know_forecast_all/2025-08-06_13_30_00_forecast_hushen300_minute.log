==========================================
训练开始时间: 2025-10-18 21:38:45
分钟: 2025-08-06 13:30:00 | 划分: forecast | 设备: cuda
标记列: train_flag_inter
==========================================
加载数据: ../data/hushen300_minute/hushen300_minute.csv
筛选分钟: 2025-08-06 13:30:00
筛选后数据行数: 86
按照 train_flag_inter=1 筛选后数据行数: 86
加载初始化模型: ./checkpoint/know_forecast_all/hushen300_minute_forecast_clear/init_model/seed_1234_0.1_lr_0.001_gen_lr_0.001_w_d_0.0_best_model.pth
使用 torch.compile 优化模型 (设备: cuda)
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/_inductor/compile_fx.py:140: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/douxueli/miniconda3/envs/iv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
Glow模型使用 CUDA
加载Glow模型: ../glow_nn_line/glow_nn_svi_2/model_500000.pt
使用 torch.compile 优化 Glow 模型
开始训练，总轮数: 20000, 第一阶段: 0
Save!Epoch 1 Loss: -0.29365;Gen: -3.63474;fit arb:  0.06982;lr: 0.00100; no_improve: 0
Save!Epoch 5 Loss: -0.28488;Gen: -3.39958;fit arb:  0.05508;lr: 0.00100; no_improve: 3
Save!Epoch 11 Loss: -0.30382;Gen: -3.51883;fit arb:  0.04806;lr: 0.00100; no_improve: 5
Save!Epoch 90 Loss: -0.30998;Gen: -3.57332;fit arb:  0.04735;lr: 0.00100; no_improve: 78
Save!Epoch 218 Loss: -0.31704;Gen: -3.63319;fit arb:  0.04627;lr: 0.00100; no_improve: 127
Save!Epoch 243 Loss: -0.32456;Gen: -3.62662;fit arb:  0.03810;lr: 0.00100; no_improve: 24
Epoch 1000 Loss: -0.26848;Gen: -3.51547;fit arb:  0.08306;lr: 0.00100;no_improve: 757
Save!Epoch 1233 Loss: -0.32786;Gen: -3.65327;fit arb:  0.03747;lr: 0.00050; no_improve: 989
Save!Epoch 1267 Loss: -0.32161;Gen: -3.58049;fit arb:  0.03644;lr: 0.00050; no_improve: 33
Save!Epoch 1321 Loss: -0.32720;Gen: -3.61090;fit arb:  0.03389;lr: 0.00050; no_improve: 53
Save!Epoch 1362 Loss: -0.33457;Gen: -3.67040;fit arb:  0.03247;lr: 0.00050; no_improve: 40
Save!Epoch 1572 Loss: -0.33190;Gen: -3.62286;fit arb:  0.03038;lr: 0.00050; no_improve: 209
Save!Epoch 1604 Loss: -0.33052;Gen: -3.60357;fit arb:  0.02983;lr: 0.00050; no_improve: 31
Save!Epoch 1946 Loss: -0.32496;Gen: -3.54125;fit arb:  0.02917;lr: 0.00050; no_improve: 341
Epoch 2000 Loss: -0.32660;Gen: -3.62869;fit arb:  0.03627;lr: 0.00050;no_improve: 54
Save!Epoch 2137 Loss: -0.33887;Gen: -3.67668;fit arb:  0.02880;lr: 0.00050; no_improve: 190
Save!Epoch 2179 Loss: -0.32906;Gen: -3.56884;fit arb:  0.02782;lr: 0.00050; no_improve: 41
Save!Epoch 2281 Loss: -0.33943;Gen: -3.65592;fit arb:  0.02616;lr: 0.00050; no_improve: 101
Save!Epoch 2589 Loss: -0.33760;Gen: -3.63084;fit arb:  0.02549;lr: 0.00050; no_improve: 307
Save!Epoch 2595 Loss: -0.33824;Gen: -3.63025;fit arb:  0.02479;lr: 0.00050; no_improve: 5
Save!Epoch 2679 Loss: -0.34700;Gen: -3.70993;fit arb:  0.02400;lr: 0.00050; no_improve: 83
Save!Epoch 2714 Loss: -0.34249;Gen: -3.64747;fit arb:  0.02226;lr: 0.00050; no_improve: 34
Save!Epoch 2775 Loss: -0.33513;Gen: -3.55545;fit arb:  0.02042;lr: 0.00050; no_improve: 60
Epoch 3000 Loss: -0.32258;Gen: -3.64704;fit arb:  0.04212;lr: 0.00050;no_improve: 225
Save!Epoch 3544 Loss: -0.34505;Gen: -3.65001;fit arb:  0.01995;lr: 0.00050; no_improve: 768
Save!Epoch 3578 Loss: -0.34632;Gen: -3.64949;fit arb:  0.01863;lr: 0.00050; no_improve: 33
Save!Epoch 3641 Loss: -0.34843;Gen: -3.66847;fit arb:  0.01841;lr: 0.00050; no_improve: 62
Save!Epoch 3647 Loss: -0.34553;Gen: -3.63273;fit arb:  0.01775;lr: 0.00050; no_improve: 5
Epoch 4000 Loss: -0.34219;Gen: -3.66512;fit arb:  0.02432;lr: 0.00050;no_improve: 353
Save!Epoch 4024 Loss: -0.34896;Gen: -3.66376;fit arb:  0.01742;lr: 0.00050; no_improve: 376
Epoch 5000 Loss: -0.34049;Gen: -3.72879;fit arb:  0.03239;lr: 0.00050;no_improve: 976
Epoch 6000 Loss: -0.34484;Gen: -3.67407;fit arb:  0.02257;lr: 0.00050;no_improve: 1976
Epoch 7000 Loss: -0.33068;Gen: -3.66204;fit arb:  0.03552;lr: 0.00050;no_improve: 2976
Epoch 8000 Loss: -0.33219;Gen: -3.70724;fit arb:  0.03853;lr: 0.00050;no_improve: 3976
Restart!Epoch 8024 Loss: -0.34000;Gen: -3.63762;fit arb:  0.02377;lr: 0.00100;no_improve: 0
Epoch 9000 Loss: -0.33152;Gen: -3.64642;fit arb:  0.03312;lr: 0.00050;no_improve: 976
Save!Epoch 9866 Loss: -0.34280;Gen: -3.59653;fit arb:  0.01685;lr: 0.00050; no_improve: 1841
Epoch 10000 Loss: -0.34366;Gen: -3.65205;fit arb:  0.02154;lr: 0.00050;no_improve: 134
Save!Epoch 10384 Loss: -0.35190;Gen: -3.67919;fit arb:  0.01602;lr: 0.00050; no_improve: 517
Epoch 11000 Loss: -0.33340;Gen: -3.67505;fit arb:  0.03410;lr: 0.00050;no_improve: 616
Epoch 12000 Loss: -0.33742;Gen: -3.65312;fit arb:  0.02790;lr: 0.00050;no_improve: 1616
Epoch 13000 Loss: -0.33271;Gen: -3.71204;fit arb:  0.03850;lr: 0.00050;no_improve: 2616
Epoch 14000 Loss: -0.34306;Gen: -3.65231;fit arb:  0.02217;lr: 0.00050;no_improve: 3616
Restart!Epoch 14384 Loss: -0.34053;Gen: -3.73866;fit arb:  0.03334;lr: 0.00100;no_improve: 0
Epoch 15000 Loss: -0.33882;Gen: -3.55875;fit arb:  0.01705;lr: 0.00050;no_improve: 616
Epoch 16000 Loss: -0.33598;Gen: -3.58426;fit arb:  0.02244;lr: 0.00050;no_improve: 1616
Epoch 17000 Loss: -0.35002;Gen: -3.68943;fit arb:  0.01892;lr: 0.00050;no_improve: 2616
Epoch 18000 Loss: -0.34953;Gen: -3.69045;fit arb:  0.01952;lr: 0.00050;no_improve: 3616
Restart!Epoch 18384 Loss: -0.32044;Gen: -3.60379;fit arb:  0.03994;lr: 0.00100;no_improve: 0
Epoch 19000 Loss: -0.32987;Gen: -3.60701;fit arb:  0.03083;lr: 0.00050;no_improve: 616
Epoch 20000 Loss: -0.33545;Gen: -3.70349;fit arb:  0.03490;lr: 0.00050;no_improve: 1616

训练完成! 分钟: 2025-08-06 13:30:00, 划分方式: forecast

==========================================
训练结束时间: 2025-10-18 21:45:36
==========================================
